{"remainingRequest":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\src\\components\\Heads.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\src\\components\\Heads.vue","mtime":1550281605421},{"path":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wu1ji\\Documents\\Mo\\Projects\\Java\\OnlineJudge\\VuePageV2\\vue-page-v2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {hex_md5} from '../assets/md5.js'\nimport {mapActions, mapState, mapGetters} from 'vuex' //注册 action 和 state\n\nexport default {\n  name: 'Heads',\n  \n  data() {\n    return {\n      active_name: \"home\",\n      user: null,\n      admin: false,\n      loginModal_flag: false,\n      formValidate: {\n        username: '',\n        passwd: '',\n        pwd: '',\n      },\n      ruleValidate: {\n        username: [\n          {required: true, message: 'The name cannot be empty', trigger: 'blur'}\n        ],\n        pwd: [\n          {required: true, message: 'Password cannot be empty', trigger: 'blur'}\n        ],\n      }\n    }\n  },\n  \n  methods: {\n    /**\n     * 登录请求\n     */\n    loginModalOk() {\n      this.$refs['formValidate'].validate((valid) => {\n        if (valid) {\n          // console.log(\"验证登录中...\");\n          /*var params = new URLSearchParams();\n          params.append('username', this.formValidate.name);\n          params.append('passwd', hex_md5(encodeURIComponent(this.formValidate.passwd + 'onlinejudge')));*/\n          this.formValidate.passwd = hex_md5(encodeURIComponent(this.formValidate.pwd + 'onlinejudge'));\n          //清除passwd\n          this.$axios({\n            url: '/api/api-oj/login',\n            method: 'post',\n            data: require('querystring').stringify(this.formValidate),\n          }).then(res => {\n            console.info('后台返回的数据', res.data);\n            if (res.data.code === 200) {\n              this.$Message.success('Success!');\n              this.$store.dispatch('login', res.data.data);\n              this.user = this.$store.state.user;\n              this.admin = this.$store.state.admin;\n              this.loginModal_flag = false;\n            } else {\n              this.loginModal_flag = true;\n              this.$Message.error(res.data.message);\n            }\n            \n          }).catch(err => {\n            console.info('报错的信息', err);\n            this.$Message.error('Fail!');\n            this.loginModal_flag = false;\n          });\n        } else {\n          this.$Message.error('input Error! Please Check!');\n          this.loginModal_flag = true;\n        }\n      });\n    },\n    \n    /**\n     * 注销请求\n     */\n    logout() {\n      //TODO 请求注销\n      this.$axios({\n        url: '/api/api-oj/logout',\n        method: 'post',\n        data: 'user_id = ' + this.user.user_id,\n      }).then(res => {\n        console.info('后台返回的数据', res.data);\n        if (res.data.code === 200) {\n        } else {\n        }\n      });\n      this.$store.dispatch('logout');\n      this.user = null;\n    },\n    \n    logger() {\n      console.log(\"md5:\" + hex_md5(encodeURIComponent('120211onlinejudge')));\n    }\n  },\n  watch: {\n    active_class: function (value, oldValue) {\n      console.log(\"检测到active-class变化:\" + value);\n      this.active_name = value;\n      this.$nextTick(function () {\n        this.$refs.menu.updateActiveName();\n        console.log(\"更新menu成功!\");\n      });\n    }\n  },\n  computed: {\n    active_class() {\n      return this.$store.state.menu_active_name;\n    }\n  },\n  created() {\n    this.user = this.$store.state.user;\n    this.admin = this.$store.state.admin;\n  }\n};\n",{"version":3,"sources":["Heads.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Heads.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"headerDiv\">\n    <Modal v-model=\"loginModal_flag\" width=\"360\" :mask-closable=\"false\" shadow>\n      <p slot=\"header\" style=\"text-align:left\">\n        <Icon type=\"ios-contact\" size=\"21\"/>\n        <span>Welcome to MOoj</span>\n      </p>\n      <Form ref=\"formValidate\" :model=\"formValidate\" :rules=\"ruleValidate\">\n        <div style=\"text-align:center; padding:3px\">\n          <FormItem label=\"\" prop=\"name\">\n            <Input v-model=\"formValidate.username\" :maxlength=\"15\" placeholder=\"请输入用户名\" style=\"width: 320px\" clearable type=\"text\">\n              <Icon type=\"ios-contact\" slot=\"prefix\"/>\n            </Input>\n          </FormItem>\n          <FormItem label=\"\" prop=\"pwd\">\n            <Input v-model=\"formValidate.pwd\" placeholder=\"请输入密码\" :maxlength=\"16\" style=\"width: 320px\" clearable type=\"password\">\n              <Icon type=\"md-key\" slot=\"prefix\"/>\n            </Input>\n          </FormItem>\n          <input v-model=\"formValidate.passwd\" style=\"display: none;\" type=\"hidden\"/>\n          <Button long type=\"success\" @click.native=\"loginModalOk()\" style=\"width: 320px\">Login</Button>\n        </div>\n      </Form>\n      <div slot=\"footer\">\n        <a style=\"float: left;\">No account? Register now!</a>\n        <a style=\"float: right;\">Forget Password</a>\n        <br>\n      </div>\n    </Modal>\n    <Row>\n      <Col span=\"24\">\n        <Menu mode=\"horizontal\" theme=\"light\" :active-name=\"active_name\" shadow ref=\"menu\">\n          <Col span=\"3\" style=\"font-size: 20px\">Online Judge</Col>\n          <MenuItem name=\"home\" to=\"/home\">\n            <!--<router-link to=\"/home\">-->\n            <Icon type=\"ios-paper\"/>\n            Home\n            <!--</router-link>-->\n          </MenuItem>\n          <MenuItem name=\"problems\" to=\"/problems\">\n            <Icon type=\"ios-people\"/>\n            Problems\n          </MenuItem>\n          <MenuItem name=\"contents\" to=\"/contents\">\n            <Icon type=\"ios-stats\"/>\n            Contents\n          </MenuItem>\n          <MenuItem name=\"status\" to=\"/status\">\n            <Icon type=\"ios-construct\"/>\n            Status\n          </MenuItem>\n          <MenuItem name=\"rank\" to=\"/rank\">\n            <Icon type=\"ios-construct\"/>\n            Rank\n          </MenuItem>\n          <MenuItem name=\"about\" @click.native=\"logger\" to=\"/about\">\n            <Icon type=\"ios-construct\"/>\n            About\n          </MenuItem>\n          <!--<Submenu name=\"7\">\n            <template slot=\"title\">\n              <Icon type=\"ios-stats\"/>\n              Login\n            </template>\n            <MenuItem name=\"7-1\">Login</MenuItem>\n            <MenuItem name=\"7-2\">Register</MenuItem>\n          </Submenu>-->\n          <Dropdown trigger=\"click\">\n            <template v-if=\"user === null\">\n              <a href=\"javascript:void(0)\">\n                Login\n                <Icon type=\"ios-arrow-down\"></Icon>\n              </a>\n              <DropdownMenu slot=\"list\">\n                <DropdownItem @click.native=\"loginModal_flag = true\">Login</DropdownItem>\n                <DropdownItem>Register</DropdownItem>\n              </DropdownMenu>\n            </template>\n            <template v-else>\n              <a href=\"javascript:void(0)\">\n                {{user.nickname}}\n                <Icon type=\"ios-arrow-down\"></Icon>\n              </a>\n              <DropdownMenu slot=\"list\">\n                <DropdownItem>Setting</DropdownItem>\n                <DropdownItem>Messages</DropdownItem>\n                <template v-if=\"admin\">\n                  <DropdownItem to=\"/admin\">Control</DropdownItem>\n                </template>\n                <DropdownItem @click.native=\"logout\">Logout</DropdownItem>\n              </DropdownMenu>\n            </template>\n          </Dropdown>\n        </Menu>\n      </Col>\n    </Row>\n    <br>\n  </div>\n</template>\n<script>\n  import {hex_md5} from '../assets/md5.js'\n  import {mapActions, mapState, mapGetters} from 'vuex' //注册 action 和 state\n  \n  export default {\n    name: 'Heads',\n    \n    data() {\n      return {\n        active_name: \"home\",\n        user: null,\n        admin: false,\n        loginModal_flag: false,\n        formValidate: {\n          username: '',\n          passwd: '',\n          pwd: '',\n        },\n        ruleValidate: {\n          username: [\n            {required: true, message: 'The name cannot be empty', trigger: 'blur'}\n          ],\n          pwd: [\n            {required: true, message: 'Password cannot be empty', trigger: 'blur'}\n          ],\n        }\n      }\n    },\n    \n    methods: {\n      /**\n       * 登录请求\n       */\n      loginModalOk() {\n        this.$refs['formValidate'].validate((valid) => {\n          if (valid) {\n            // console.log(\"验证登录中...\");\n            /*var params = new URLSearchParams();\n            params.append('username', this.formValidate.name);\n            params.append('passwd', hex_md5(encodeURIComponent(this.formValidate.passwd + 'onlinejudge')));*/\n            this.formValidate.passwd = hex_md5(encodeURIComponent(this.formValidate.pwd + 'onlinejudge'));\n            //清除passwd\n            this.$axios({\n              url: '/api/api-oj/login',\n              method: 'post',\n              data: require('querystring').stringify(this.formValidate),\n            }).then(res => {\n              console.info('后台返回的数据', res.data);\n              if (res.data.code === 200) {\n                this.$Message.success('Success!');\n                this.$store.dispatch('login', res.data.data);\n                this.user = this.$store.state.user;\n                this.admin = this.$store.state.admin;\n                this.loginModal_flag = false;\n              } else {\n                this.loginModal_flag = true;\n                this.$Message.error(res.data.message);\n              }\n              \n            }).catch(err => {\n              console.info('报错的信息', err);\n              this.$Message.error('Fail!');\n              this.loginModal_flag = false;\n            });\n          } else {\n            this.$Message.error('input Error! Please Check!');\n            this.loginModal_flag = true;\n          }\n        });\n      },\n      \n      /**\n       * 注销请求\n       */\n      logout() {\n        //TODO 请求注销\n        this.$axios({\n          url: '/api/api-oj/logout',\n          method: 'post',\n          data: 'user_id = ' + this.user.user_id,\n        }).then(res => {\n          console.info('后台返回的数据', res.data);\n          if (res.data.code === 200) {\n          } else {\n          }\n        });\n        this.$store.dispatch('logout');\n        this.user = null;\n      },\n      \n      logger() {\n        console.log(\"md5:\" + hex_md5(encodeURIComponent('120211onlinejudge')));\n      }\n    },\n    watch: {\n      active_class: function (value, oldValue) {\n        console.log(\"检测到active-class变化:\" + value);\n        this.active_name = value;\n        this.$nextTick(function () {\n          this.$refs.menu.updateActiveName();\n          console.log(\"更新menu成功!\");\n        });\n      }\n    },\n    computed: {\n      active_class() {\n        return this.$store.state.menu_active_name;\n      }\n    },\n    created() {\n      this.user = this.$store.state.user;\n      this.admin = this.$store.state.admin;\n    }\n  };\n</script>\n"]}]}